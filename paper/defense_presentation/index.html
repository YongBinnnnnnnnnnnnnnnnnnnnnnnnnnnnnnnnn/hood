<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<title>Design and implementation of a firewall system for working in unsafe environments</title>

	<meta name="author" content="Bin Yong">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/reset.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/reveal.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/theme/black.min.css" id="theme">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/highlight/monokai.min.css">
	<style>
		.reveal h3 {
			text-transform: none;
		}

		.reveal .slide-number {
			font-size: 40px;
			left: 8px;
			right: unset;
			bottom: 8px;
		}
	</style>
</head>

<body>

	<div class="reveal">

		<!-- Any section element inside of this container is displayed as a slide -->
		<div class="slides">
			<section>
				<h3>Design and implementation of a firewall system for working in unsafe environments</h3>
				<p>Bin Yong</p>
				<p>February 2024</p>
			</section>

			<section>
				<h2>Acknowledgements</h2>
				<p>
					This document is licensed under Creative Commons BY-NC-ND 4.0.
				</p>
				<p>
					<a
						href="https://creativecommons.org/licenses/by-nc-nd/4.0/">https://creativecommons.org/licenses/by-nc-nd/4.0/</a>
				</p>

			</section>

			<!-- Example of nested vertical slides -->
			<section>
				<section>
					<h2>Introduction</h2>
					<p>The title says "unsafe environment" but safety is actually a relative thing: whether an
						environment
						is safe depends on the threat model.</p>
					<p>So it is a firewall system for anyone who cares.</p>
					<br>
				</section>
				<section data-auto-animate>
					<h2 data-id="code-title">Problems come from everywhere</h2>

					<p>On 2017, an attack to Amazon Echo can <span class="hljs-keyword">steal</span> customer
						authentication
						<span class="hljs-keyword">token and</span> can to <span class="hljs-keyword">stream</span> live
						<span class="hljs-keyword">microphone</span> audio to remote <span
							class="hljs-keyword">without</span> leaving physical <span
							class="hljs-keyword">evidence</span>
						of tampering and without altering the functionality of the device <a
							href="https://labs.withsecure.com/publications/alexa-are-you-listening">SOURCE</a>.
					</p>
				</section>
				<section data-auto-animate>
					<h2 data-id="code-title">Problems come from everywhere</h2>
					<p>A malware named DogeRat has following abilities in its free version <a
							href="https://github.com/shivaya-dav/DogeRat">SOURCE</a>.</p>
					<pre data-id="code-animation"><code class="hljs lang-trojanability" data-trim data-line-numbers>
						Real time
						custom web view
						notification reader
						notification sender
						show toast message on target device
						receive information about simcard provider
						vibrate target device
						receive device location
						receive all target message
						send sms with target device to any number
						send sms with target device to all of his/her contacts
						recive all target contacts
						receive list of all installedd apps in target device
						capture main and front camera
						capture microphone
						receive last clipboard text
						auto start after device boot
						Keylogger
						Beautiful telegram bot interface
					</code></pre>
				</section>
				<section data-auto-animate>
					<h2>Problems come from everywhere</h2>
					<p>
						And here is another named AndroRAT listed following features <a
							href="https://github.com/karma9874/AndroRAT">SOURCE</a>
					</p>
					<pre data-id="code-animation"><code class="hljs lang-trojanability" data-trim data-line-numbers>
					Full persistent backdoor
					Invisible icon on install
					Light weight apk which runs 24*7 in background
					App starts automatically on boot up
					Can record audio, video, take picture from both camera
					Browse call logs and SMS logs
					Get current location, sim card details ,ip, mac address of the device
					</code></pre>
				</section>
				<section data-auto-animate>
					<h2>Problems come from everywhere</h2>
					<p>
						Additionally, the one named Teardroid v4 has the ability of <span class="hljs-keyword">making
							phone
							calls</span> <a href="https://github.com/ScRiPt1337/Teardroid-phprat">SOURCE</a>
					</p>
				</section>

				<section>
					<h2>What if I don't browse/click ...?</h2>
					<p><span class="hljs-keyword">They don't need!</span></p>
					<p>In 2023, BLASTPASS, NSO Group iPhone Zero-Click, Zero-Day Exploit Captured in the Wild <a
							href="https://citizenlab.ca/2023/09/blastpass-nso-group-iphone-zero-click-zero-day-exploit-captured-in-the-wild/">SOURCE</a>
					</p>
					<p>In 2022, PWNYOURHOME, FINDMYPWN, and LATENTIMAGE, at least three Zero-Click exploit chains were
						used in real-world attacks <a
							href="https://citizenlab.ca/2023/04/nso-groups-pegasus-spyware-returns-in-2022/">SOURCE</a>
					</p>
					<p>In 2021, FORCEDENTRY, NSO Group iMessage Zero-Click Exploit Captured in the Wilda <a
							href="https://citizenlab.ca/2021/09/forcedentry-nso-group-imessage-zero-click-exploit-captured-in-the-wild/">SOURCE</a>
					</p>
				</section>

				<section>
					<h2>Would be better to have something to monitor the network</h2>
					<p>
						TODO:HOOD PIC
					</p>
				</section>
			</section>


			<section>
				<h2>First supported hardware: Raspberry Pi</h2>
				<p>
					Raspberry Pi 4B has sufficient hardware and software support to work as the USB device I wanted. Its
					price is also much lower than the majority of commercial firewalls. It is not the cheapest option
					that can fit the design, but it is a good choice after evaluating technical support and user base.
				</p>
			</section>

			<section>
				<h2>Packet filtering and forwarding in general</h2>
				<ul>
					<li>Use proxies to prevent hidden data transfer and to erase TCP fingerprints</li>
					<li>Allow only things to make HTTPS done as a balance between security and compatibility</li>
				</ul>
			</section>

			<section>
				<h2>Typical sequence of protocols used when accessing a HTTPS website</h2>
				<img alt="typical-sequence-of-https.png"
					src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png">
			</section>

			<section class="yongbin-dhcp">
				<style>
					#dhcp-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#dhcp-float-image-rectangle {
						position: fixed;
						top: 80px;
						left: 35px;
						margin-top: 0;
						height: 60px;
						width: 420px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_dhcp_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#dhcp-float-image");
							if (event.currentSlide.classList.contains("yongbin-dhcp")) {
								if (image) {
									return;
								}
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "dhcp-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "dhcp-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#dhcp-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>
				<h2>DHCP</h2>
				<div>
					<p>Leakage</p>
					<ul>
						<li>MAC address -> <a href="https://www.wireshark.org/tools/oui-lookup.html">manufacturer</a> ->
							owner</li>
						<li>Hostname -> owner (YongBin's MacBook Pro)</li>
					</ul>
					<div id="dhcp-router-image-container">
						<img id="dhcp-router-image"
							src="https://static.tp-link.com/resources/UploadFiles/image006(7).jpg">
					</div>
					<p><small>Figure: what network adminisitors can see from a router <a
								href="https://www.tp-link.com/us/support/faq/363/">SOURCE</a></small></p>
					<style>
						#dhcp-router-image-container {
							display: inline-block;
							width: 554px;
							height: 120px;
							overflow: hidden;
						}

						#dhcp-router-image {
							float: right;
							width: 100%;
							height: 100%;
							object-fit: none;
							object-position: 0 30%;
						}
					</style>
				</div>
				<p>Solution: randomization</p>
			</section>

			<section class="yongbin-dns">
				<style>
					#dns-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#dns-float-image-rectangle {
						position: fixed;
						top: 140px;
						left: 35px;
						margin-top: 0;
						height: 30px;
						width: 510px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_dns_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#dns-float-image");
							if (event.currentSlide.parentNode.classList.contains("yongbin-dns")) {
								if (image) {
									return;
								}
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "dns-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "dns-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#dns-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>
				<section>
					<h2>DNS - Simplified</h2>
					<small>Computer -> DNS server: The address of "domain" "Forbidden City" / "google.com"?</small>
					<small>Computer <- DNS server: "Dongcheng District, Beijing, China" / "w.y.e.x" </small>
				</section>
				<section>
					<h2>DNS - Leakage</h2>
					<img src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/defense_presentation/images/dns-leak.png"
						style="width:60%;">
					<p><small>Figure: what network adminisitors can see from common DNS requests <a
								href="https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/dns.cap">SOURCE</a></small>
					</p>
				</section>
				<section>
					<h2>DNS - Attack</h2>
					<small>Computer -> DNS server: The address of "domain" "Forbidden City" / "google.com"?</small>
					<small>Computer <- DNS server: "1600 Pennsylvania Avenue NW, Washington, D.C., USA" / "a.b.c.d"
							</small>
							<p>Firewall project used this attack to apply proxies</p>

				</section>
				<section>
					<h2>Solutions</h2>
					<ul>
						<li>DNSSEC: results are protected by signatures but still in plaintext, chicken and egg</li>
						<li>DNSCrypt: encrypted communication but not having a RFC document</li>
						<li>DNS over TLS: encrypted communication but can be easily identifed by port number 853</li>
						<li>âœ“DNS over HTTPS: encrypted communication</li>
					</ul>
				</section>
			</section>

			<section class="yongbin-tls">
				<style>
					#tls-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#tls-float-image-rectangle {
						position: fixed;
						top: 170px;
						left: 35px;
						margin-top: 0;
						height: 30px;
						width: 640px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_tls_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#tls-float-image");
							if (event.currentSlide.parentNode.classList.contains("yongbin-tls")) {
								if (image) {
									return;
								}
								console.log(1);
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "tls-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "tls-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#tls-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>

				<section>
					<h2>TLS - Oversimplified</h2>
					<ul style="font-size: 4vh;">
						<li>Computer -> Server: Hello, [random1]</li>
						<li>Server: Generate [random2]</li>
						<li>Computer <- Server: Hello, [certificate], private key encrypted [random2]</li>
						<li>Computer: Is [certificate] signed by a trusted authority (CA)? Verify certificate</li>
						<li>Computer: get [random2] with known public key </li>
						<li>Computer -> Server: public key encrypted [random3]</li>
						<li>Server and Computer: get key "ABCD" from random1, random2, and random3</li>
						<li>Computer <-> Server: data encrypted by key "ABCD" </li>
					</ul>
				</section>
				<section>
					<h2>TLS - Leakage</h2>
					<img src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/defense_presentation/images/tls-leak.png"
						style="width:60%;">
					<p><small>Figure: what network adminisitors can see from common TLS requests <a
								href="https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/tls.cap">SOURCE</a></small>
					</p>
				</section>
				<section>
					<h2>TLS - Simplified Man-In-The-Middle (MITM) Attack</h2>
					<ul style="font-size: 4vh;">
						<li>Computer -> Server: Hello, [random1]</li>
						<li>Server: Generate [random2]</li>
						<li>Computer <- <span class="hljs-keyword">MITM</span>: Hello, [<span
									class="hljs-keyword">replaced</span> certificate], private key encrypted [random2]
						</li>
						<li>Computer: Is [<span class="hljs-keyword">replaced</span> certificate] signed by a trusted
							authority (CA)? Verify certificate</li>
						<li>Computer: get [random2] with known public key </li>
						<li>Computer -> <span class="hljs-keyword">MITM</span>: public key encrypted [random3]</li>
						<li><span class="hljs-keyword">MITM</span> and Computer: get key "ABCD" from random1, random2,
							and random3</li>
						<li>Computer <-> <span class="hljs-keyword">MITM</span>: data encrypted by key "ABCD" </li>
					</ul>
				</section>
				<section>
					<h2>Certificate pinning</h2>
					<ul style="font-size: 4vh;">
						<li>Computer -> Server: Hello, [random1]</li>
						<li>Server: Generate [random2]</li>
						<li>Computer <- Server: Hello, [certificate], private key encrypted [random2]</li>
						<li>Computer: Is [certificate] signed by <span class="hljs-keyword"><del>a trusted authority
									(CA)</del> the authority YongBin</span>? Verify certificate</li>
						<li>Computer: get [random2] with known public key </li>
						<li>Computer -> Server: public key encrypted [random3]</li>
						<li>Server and Computer: get key "ABCD" from random1, random2, and random3</li>
						<li>Computer <-> Server: data encrypted by key "ABCD" </li>
					</ul>
				</section>
				<section>
					<h2>TLS - Mismatch problem</h2>
					<p>In March 2021, Internet Engineering Task Force (IETF) published RFC 8996: Deprecating TLS 1.0 and
						TLS 1.1, but until today...</p>
					<img src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/defense_presentation/images/python-ssl.png"
						style="width:60%;">
				</section>
				<section>
					<h2>Solution</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/process-tls-traffic.png">
				</section>
				<section>
					<h2>Solution - Proxy</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/process-tls-proxy.png">
				</section>
			</section>

			<section class="yongbin-http">
				<style>
					#http-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#http-float-image-rectangle {
						position: fixed;
						top: 200px;
						left: 35px;
						margin-top: 0;
						height: 30px;
						width: 640px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_http_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#http-float-image");
							if (event.currentSlide.parentNode.classList.contains("yongbin-http")) {
								if (image) {
									return;
								}
								console.log(1);
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "http-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "http-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#http-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>

				<section>
					<h2>Handling plaintext connections</h2>
				</section>
				<section>
					<h2>Design</h2>
					<p>
						Plaintext HTTP connections should be tunneled and encrypted through TLS proxy, if the
						remote server does not support encrypted connections, the request should fail.
					</p>
				</section>
				<section>
					<h2>Implementation</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/process-http-traffic.png">
				</section>
				<section>
					<h2>Implementation</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/process-ocsp-traffic.png">
				</section>
			</section>
			<section>
				<section>
					<h2>Date time synchornization</h2>
				</section>
				<section>
					<h2>Limitation of Raspberry Pi</h2>
					<p>No having a battery to keep the clock ticking</p>
				</section>
				<section>
					<h2>Network Time Protocol</h2>
					<div style="text-align: left;">
						<p>The triditional way to synchornize time between computer and network.</p>
						<p>Leak information by domain names (time.windows.com, time.apple.com, and ubuntu.pool.ntp.org).
						</p>
						<p>Targeted by attackers and can be attacked <a
								href="https://www.usenix.org/system/files/usenixsecurity23-kwon.pdf">SOURCE</a></p>
					</div>
				</section>
				<section>
					<h2>Design</h2>
					<p style="text-align: left;">Give up on NTP, use HTTP/HTTPS instead. Use the "Date" header from the
						response of an HTTP server to synchronize date time with acceptable accuracy. To hide from
						security detection, the attack vectors targeted to HTTP/HTTPS protocol usually do not want to
						make mistakes in the header. Even if an attacker targeted the method used by the hood firewall,
						It's hard to say whether this request is made for time synchronization. Thus the date field of
						an HTTP response is generally trustworthy.</p>
				</section>
				<section>
					<h2>Implementation: hood-timesync.py</h2>
					<ol style="font-size: 4vh;">
						<li>Try get date from HTTPS</li>
						<li>If failed, try get date from HTTP</li>
						<li>If successed, try get date from HTTPS</li>
						<li>Upon receiving a date: check with hard-coded anchor, accept only the date after the anchor
						</li>
					</ol>
				</section>
			</section>
			<section>
				<section>
					<h2>Network activity simulation</h2>
				</section>
				<section>
					<h2>The sad truth</h2>
					<p>The combination of all efforts on those protocols is not enough when facing a more
						sophisticated network analysis. The connections to update servers can be used to detect devices.
						and the domain name leaked from TLS handshakes both telling eavesdroppers stories.
						Virtual private networks (VPNs) may prevent that information from being captured by local
						eavesdroppers but VPNs also have an egress, where could have other eavesdroppers. Thus, when
						visiting internet websites, the leak of information is inevitable. </p>
				</section>
				<section>
					<h2>Design</h2>
					<div style="text-align: left;">
						<p>Goal: hide user network activities inside the flood of fake network activities to
							increase the difficulty of an analyzer to produce useful reports.</p>
						<p> Risk: produce a false alarm immediately and make the user blocked for
							tethering, make the user fired for browsing unrelated websites, etc. </p>
					</div>
				</section>
				<section>
					<h2>Design</h2>
					<div style="text-align: left;">
						<p>To prevent the firewall from being compromised by browser vulnerabilities, browser-based
							simulation tools should not be used for implementation. It should also make plaintext
							traffic to attract attention from attackers and eavesdroppers to make them less focused on
							the actual user traffic.</p>
					</div>
				</section>
				<section>
					<h2>Implementation</h2>
					<p style="text-align: left;">The service is implemented in a Python script named hood-actor.py. It
						can parse and execute action files. To simulate the behaviors of a human user or a computer
						service. All implementations inside the script are based on the base modules of Python, to avoid
						the version management of third-party libraries being involved in the installation process of
						the firewall.</p>
				</section>
				<section>
					<h2>Action file example</h2>
					<pre data-id="code-animation" style="font-size: 1vh;"><code class="hljs lang-json" data-trim data-line-numbers>
[
  {
    "type": "properties",
    "safe_age": 0,
    "proper_age": [
      6,
      3000
    ]
  },
  {
    "type": "task",
    "name": "browse",
    "before": [],
    "after": [],
    "delay_between_actions": [
      5,
      20
    ],
    "actions": [
      "hood:browser:goto:http://www.bing.com",
      "hood:browser:goto:http://www.bing.com/news/search",
      "hood:loop:exit_chance=0.8,delay=10-30:hood:browser:goto:random_link"
    ]
  }
]
					</code></pre>
				</section>
				<section>
					<h2>HoodExecutor</h2>
					<p style="text-align: left;">A general-purpose multi-thread task executor written in Python. It is
						part of hood-actor.py It can run and schedule in parallel tasks that have dependency
						relationships and delay requirements. It has a thread pool of worker to execute tasks and a
						single thread for scheduling delayed tasks.</p>
				</section>
				<section>
					<h2>Browser</h2>
					<p style="text-align: left;">A fake browser is created to simulate network activities of browsing.
						It respect cookies and load resources of the webpage in parallel. It uses headers that are used
						by real browsers and uses different headers on different resources. Cookies are stored in memory
						and used in the running session.</p>
				</section>
				<section>
					<h2>Browser</h2>
					<p style="text-align: left;">A fake browser is created to simulate network activities of browsing.
						It respect cookies and load resources of the webpage in parallel. It uses headers that are used
						by real browsers and uses different headers on different resources. Cookies are stored in memory
						and used in the running session.</p>
				</section>
				<section>
					<h2>Hood action script</h2>
					<p style="text-align: left;">A Just-In-Time compiler is implemented to convert the CONDITION field
						into Python code.</p>
				</section>
				<section>
					<h2>Logical view</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/actor.png">
				</section>
			</section>
			<section>
				<section>
					<h2>Dispatcher and firewall rules</h2>
					<p>
						This firewall system use a dispatcher to interact with the changes in the network status or the
						system status to dynamically configure firewall rules and to start or stop network services
						while most firewalls use static rules after configuration.
					</p>
				</section>
				<section>
					<h2>Initial rules</h2>
					<ul>
						<li>Allow IPv4 and ARP</li>
						<li>Allow connecting to 'lo'</li>
						<li>Disallow other interfaces to send packets from/to 127.0.0.0/8</li>
						<li>Allow ICMP fragmentation-needed packets</li>
						<li>Drop other packets</li>
					</ul>
				</section>
				<section>
					<h2>Interaction to WAN port</h2>
					<ul>
						<li>A new network device added to firewall: Accept only IPv4 and ARP</li>
						<li>A network device connected to network: Allow DHCP to receive IP address, DNS server, and
							Gateway</li>
						<li>DHCP done: Disallow DHCP, allow outbound TCP connection using the assigned ip to 80, 443,
							and other ports if configured; Do time synchornization.</li>
					</ul>
				</section>
				<section>
					<h2>Interaction to LAN port</h2>
					<ul>
						<li>Accept only IPv4 and ARP</li>
						<li>Accept incoming DHCP UDP packets</li>
						<li>Accept incoming DNS UDP packets</li>
						<li>Accept incoming HTTP/HTTPS connections</li>
						<li>Set a randomized IP address</li>
						<li>Start a dnsmasq instance to do basic DHCP and to do DNS attack</li>
					</ul>
				</section>
			</section>
			<section style="text-align: left;">
				<h1>THE END</h1>
				<p>
					Project homepage: <a
						href="https://github.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood">https://github.com/YongBin<br />nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood</a>
				</p>
				<p>(YongBin + 32 'n's, 33 'n' in total)</p>
			</section>
			<section>
				<h2>Clever Quotes</h2>
				<p>
					These guys come in two forms, inline: <q
						cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">The
						nice thing about standards is that there are so many to choose from</q> and block:
				</p>
				<blockquote
					cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
					&ldquo;For years there has been a theory that millions of monkeys typing at random on millions of
					typewriters would
					reproduce the entire works of Shakespeare. The Internet has proven this theory to be untrue.&rdquo;
				</blockquote>
			</section>

			<section>
				<h2>Speaker View</h2>
				<p>There's a <a href="https://revealjs.com/speaker-view/">speaker view</a>. It includes a timer, preview
					of the upcoming slide as well as your speaker notes.</p>
				<p>Press the <em>S</em> key to try it out.</p>

				<aside class="notes">
					Oh hey, these are some notes. They'll be hidden in your presentation, but you can see them if you
					open the speaker notes window (hit 's' on your keyboard).
				</aside>
			</section>

		</div>

	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/reveal.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/zoom/zoom.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/notes/notes.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/search/search.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/markdown/markdown.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/highlight/highlight.min.js"></script>
	<script lang="javascript">
		// Also available as an ES module, see:
		// https://revealjs.com/initialization/
		Reveal.initialize({
			controls: true,
			progress: true,
			center: true,
			hash: true,
			slideNumber: true,

			highlight: {
				beforeHighlight: hljs => {
					hljs.registerLanguage('trojanability', function () {
						return {
							case_insensitive: false, // language is case-insensitive
							keywords: { keyword: 'camera microphone sms location call clipboard without steal token tokens evidence stream' },
							contains: []
						}
					})
				}
			},

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight]
		})
		register_dhcp_slide_handler();
		register_dns_slide_handler();
		register_tls_slide_handler();
		register_http_slide_handler();

	</script>

</body>

</html>
