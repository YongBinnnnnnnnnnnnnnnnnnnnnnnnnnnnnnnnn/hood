<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<title>Design and implementation of a firewall system for working in unsafe environments</title>

	<meta name="author" content="Bin Yong">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/reset.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/reveal.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/theme/black.min.css" id="theme">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/highlight/monokai.min.css">
	<style>
		.reveal h3 {
			text-transform: none;
		}

		.reveal .slide-number {
			font-size: 40px;
			left: 8px;
			right: unset;
			bottom: 8px;
		}
	</style>
</head>

<body>

	<div class="reveal">

		<!-- Any section element inside of this container is displayed as a slide -->
		<div class="slides">
			<section>
				<h3>Design and implementation of a firewall system for working in unsafe environments</h3>
				<p>Bin Yong</p>
				<p>February 2024</p>
			</section>

			<section>
				<h2>Acknowledgements</h2>
				<p>
					This document is licensed under Creative Commons BY-NC-ND 4.0.
				</p>
				<p>
					<a
						href="https://creativecommons.org/licenses/by-nc-nd/4.0/">https://creativecommons.org/licenses/by-nc-nd/4.0/</a>
				</p>

			</section>

			<!-- Example of nested vertical slides -->
			<section>
				<section>
					<h2>Introduction</h2>
					<p>The title says "unsafe environment" but safety is actually a relative thing: whether an
						environment
						is safe depends on the threat model.</p>
					<p>So it is a firewall system for anyone who cares.</p>
					<br>
				</section>
				<section data-auto-animate>
					<h2 data-id="code-title">Problems come from everywhere</h2>

					<p>On 2017, an attack to Amazon Echo can <span class="hljs-keyword">steal</span> customer
						authentication
						<span class="hljs-keyword">token and</span> can to <span class="hljs-keyword">stream</span> live
						<span class="hljs-keyword">microphone</span> audio to remote <span
							class="hljs-keyword">without</span> leaving physical <span
							class="hljs-keyword">evidence</span>
						of tampering and without altering the
						functionality of the device <a
							href="https://labs.withsecure.com/publications/alexa-are-you-listening">source here</a>.
					</p>
				</section>
				<section data-auto-animate>
					<h2 data-id="code-title">Problems come from everywhere</h2>
					<p>A malware named DogeRat has following abilities in its free version <a
							href="https://github.com/shivaya-dav/DogeRat">source here</a>.</p>
					<pre data-id="code-animation"><code class="hljs lang-trojanability" data-trim data-line-numbers>
						Real time
						custom web view
						notification reader
						notification sender
						show toast message on target device
						receive information about simcard provider
						vibrate target device
						receive device location
						receive all target message
						send sms with target device to any number
						send sms with target device to all of his/her contacts
						recive all target contacts
						receive list of all installedd apps in target device
						capture main and front camera
						capture microphone
						receive last clipboard text
						auto start after device boot
						Keylogger
						Beautiful telegram bot interface
					</code></pre>
				</section>
				<section data-auto-animate>
					<h2>Problems come from everywhere</h2>
					<p>
						And here is another named AndroRAT listed following features<a
							href="https://github.com/karma9874/AndroRAT">source</a>
					</p>
					<pre data-id="code-animation"><code class="hljs lang-trojanability" data-trim data-line-numbers>
					Full persistent backdoor
					Invisible icon on install
					Light weight apk which runs 24*7 in background
					App starts automatically on boot up
					Can record audio, video, take picture from both camera
					Browse call logs and SMS logs
					Get current location, sim card details ,ip, mac address of the device
					</code></pre>
				</section>
				<section data-auto-animate>
					<h2>Problems come from everywhere</h2>
					<p>
						Additionally, the one named Teardroid v4 has the ability of <span class="hljs-keyword">making
							phone
							calls</span> <a href="https://github.com/ScRiPt1337/Teardroid-phprat">source</a>
					</p>
				</section>

				<section>
					<h2>What if I don't browse/click ...?</h2>
					<p><span class="hljs-keyword">They don't need!</span></p>
					<p>In 2023, BLASTPASS, NSO Group iPhone Zero-Click, Zero-Day Exploit Captured in the Wild <a
							href="https://citizenlab.ca/2023/09/blastpass-nso-group-iphone-zero-click-zero-day-exploit-captured-in-the-wild/">source</a>
					</p>
					<p>In 2022, PWNYOURHOME, FINDMYPWN, and LATENTIMAGE, at least three exploit chains were used in
						real-world attacks <a
							href="https://citizenlab.ca/2023/04/nso-groups-pegasus-spyware-returns-in-2022/">source</a>
					</p>
					<p>In 2021, FORCEDENTRY, NSO Group iMessage Zero-Click Exploit Captured in the Wilda <a
							href="https://citizenlab.ca/2021/09/forcedentry-nso-group-imessage-zero-click-exploit-captured-in-the-wild/">source</a>
					</p>
				</section>

				<section>
					<h2>Would be better to have something to monitor the network</h2>
					<p>
						TODO:HOOD PIC
					</p>
				</section>
			</section>


			<section>
				<h2>First supported hardware: Raspberry Pi</h2>
				<p>
					Raspberry Pi 4B has sufficient hardware and software support to work as the USB device I wanted. Its
					price is also much lower than the majority of commercial firewalls. It is not the cheapest option
					that can fit the design, but it is a good choice after evaluating technical support and user base.
				</p>
			</section>

			<section>
				<h2>Typical sequence of protocols used when accessing a HTTPS website</h2>
				<img alt="typical-sequence-of-https.png"
					src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png">
			</section>

			<section class="yongbin-dhcp">
				<style>
					#dhcp-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#dhcp-float-image-rectangle {
						position: fixed;
						top: 80px;
						left: 35px;
						margin-top: 0;
						height: 60px;
						width: 420px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_dhcp_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#dhcp-float-image");
							if (event.currentSlide.classList.contains("yongbin-dhcp")) {
								if (image) {
									return;
								}
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "dhcp-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "dhcp-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#dhcp-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>
				<h2>DHCP</h2>
				<div>
					<p>Leakage</p>
					<ul>
						<li>MAC address -> <a href="https://www.wireshark.org/tools/oui-lookup.html">manufacturer</a> ->
							owner</li>
						<li>Hostname -> owner (YongBin's MacBook Pro)</li>
					</ul>
					<div id="dhcp-router-image-container">
						<img id="dhcp-router-image"
							src="https://static.tp-link.com/resources/UploadFiles/image006(7).jpg">
					</div>
					<p><small>Figure: what network adminisitors can see from a router <a
								href="https://www.tp-link.com/us/support/faq/363/">source</a></small></p>
					<style>
						#dhcp-router-image-container {
							display: inline-block;
							width: 554px;
							height: 120px;
							overflow: hidden;
						}

						#dhcp-router-image {
							float: right;
							width: 100%;
							height: 100%;
							object-fit: none;
							object-position: 0 30%;
						}
					</style>
				</div>
				<p>Solution: randomization</p>
			</section>

			<section class="yongbin-dns">
				<style>
					#dns-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#dns-float-image-rectangle {
						position: fixed;
						top: 140px;
						left: 35px;
						margin-top: 0;
						height: 30px;
						width: 510px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_dns_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#dns-float-image");
							if (event.currentSlide.parentNode.classList.contains("yongbin-dns")) {
								if (image) {
									return;
								}
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "dns-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "dns-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#dns-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>
				<section>
					<h2>DNS - Simplified</h2>
					<small>Computer -> DNS server: The address of "domain" "Forbidden City" / "google.com"?</small>
					<small>Computer <- DNS server: "Dongcheng District, Beijing, China" / "w.y.e.x" </small>
				</section>
				<section>
					<h2>DNS - Leakage</h2>
					<img src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/defense_presentation/images/dns-leak.png"
						style="width:60%;">
					<p><small>Figure: what network adminisitors can see from common DNS requests <a
								href="https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/dns.cap">source</a></small>
					</p>
				</section>
				<section>
					<h2>DNS - Attack</h2>
					<small>Computer -> DNS server: The address of "domain" "Forbidden City" / "google.com"?</small>
					<small>Computer <- DNS server: "1600 Pennsylvania Avenue NW, Washington, D.C., USA" / "a.b.c.d"
							</small>
							<p>Firewall project used this attack to apply proxies</p>

				</section>
				<section>
					<h2>Solutions</h2>
					<ul>
						<li>DNSSEC: results are protected by signatures but still in plaintext, chicken and egg</li>
						<li>DNSCrypt: encrypted communication but not having a RFC document</li>
						<li>DNS over TLS: encrypted communication but can be easily identifed by port number 853</li>
						<li>✓DNS over HTTPS: encrypted communication</li>
					</ul>
				</section>
			</section>

			<section class="yongbin-tls">
				<style>
					#tls-float-image {
						display: inline;
						position: fixed;
						top: 0;
						left: 0;
						margin-top: 0;
						opacity: 0.5;
					}

					#tls-float-image-rectangle {
						position: fixed;
						top: 170px;
						left: 35px;
						margin-top: 0;
						height: 30px;
						width: 640px;
						background-color: #f00;
						opacity: 0.3;
					}
				</style>
				<script>
					function register_tls_slide_handler() {
						Reveal.on('slidechanged', event => {
							// event.previousSlide, event.currentSlide, event.indexh, event.indexv
							let image = document.querySelector("#tls-float-image");
							if (event.currentSlide.parentNode.classList.contains("yongbin-tls")) {
								if (image) {
									return;
								}
								console.log(1);
								image = document.createElement("img");
								image.src = "https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/typical-sequence-of-https.png";
								image.id = "tls-float-image";
								document.body.appendChild(image);
								image = document.createElement("div");
								image.id = "tls-float-image-rectangle";
								document.body.appendChild(image);
							} else {
								console.log(image);
								if (image) {
									document.body.removeChild(image);
									image = document.querySelector("#tls-float-image-rectangle");
									document.body.removeChild(image);
								}
							}
						});
					}
				</script>

				<section>
					<h2>TLS - Oversimplified</h2>
					<ul style="font-size: 4vh;">
						<li>Computer -> Server: Hello, [random1]</li>
						<li>Server: Generate [random2]</li>
						<li>Computer <- Server: Hello, [certificate], private key encrypted [random2]</li>
						<li>Computer: Is [certificate] signed by a trusted authority (CA)? Verify certificate</li>
						<li>Computer: get [random2] with known public key </li>
						<li>Computer -> Server: public key encrypted [random3]</li>
						<li>Server and Computer: get key "ABCD" from random1, random2, and random3</li>
						<li>Computer <-> Server: data encrypted by key "ABCD" </li>
					</ul>
				</section>
				<section>
					<h2>TLS - Leakage</h2>
					<img src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/defense_presentation/images/tls-leak.png"
						style="width:60%;">
					<p><small>Figure: what network adminisitors can see from common TLS requests <a
								href="https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/tls.cap">source</a></small>
					</p>
				</section>
				<section>
					<h2>TLS - Attack</h2>
					<small>Computer -> TLS server: The address of "domain" "Forbidden City" / "google.com"?</small>
					<small>Computer <- TLS server: "1600 Pennsylvania Avenue NW, Washington, D.C., USA" / "a.b.c.d"
							</small>
							<p>Firewall project used this attack to apply proxies</p>

				</section>
				<section>
					<h2>Certificate pinning</h2>
					<ul>
						<li>Computer -> Server: Hello</li>
						<li>Computer <- Server: Hello, [certificate], [encrypted data]</li>
						<li>Computer: Is [certificate] signed by a trusted authority (CA)? Verify certificate</li>
						<li>Computer: Decrypt [encrypted data] with known public key: let's encrypt data by key "ABCD"
						</li>
						<li>Computer -> Server: data encrypted by key "ABCD" </li>
					</ul>
				</section>
				<section>
					<h2>Solution</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/process-tls-traffic.png">
				</section>
				<section>
					<h2>Solution - Proxy</h2>
					<img
						src="https://raw.githubusercontent.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood/main/paper/graphics/puml/process-tls-proxy.png">
				</section>
			</section>

			<section>
				<h2>Clever Quotes</h2>
				<p>
					These guys come in two forms, inline: <q
						cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">The
						nice thing about standards is that there are so many to choose from</q> and block:
				</p>
				<blockquote
					cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
					&ldquo;For years there has been a theory that millions of monkeys typing at random on millions of
					typewriters would
					reproduce the entire works of Shakespeare. The Internet has proven this theory to be untrue.&rdquo;
				</blockquote>
			</section>

			<section>
				<h2>Speaker View</h2>
				<p>There's a <a href="https://revealjs.com/speaker-view/">speaker view</a>. It includes a timer, preview
					of the upcoming slide as well as your speaker notes.</p>
				<p>Press the <em>S</em> key to try it out.</p>

				<aside class="notes">
					Oh hey, these are some notes. They'll be hidden in your presentation, but you can see them if you
					open the speaker notes window (hit 's' on your keyboard).
				</aside>
			</section>

			<section>
				<h2>Global State</h2>
				<p>
					Set <code>data-state="something"</code> on a slide and <code>"something"</code>
					will be added as a class to the document element when the slide is open. This lets you
					apply broader style changes, like switching the page background.
				</p>
			</section>

			<section style="text-align: left;">
				<h1>THE END</h1>
				<p>
					Project homepage: <a
						href="https://github.com/YongBinnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood">https://github.com/YongBin<br />nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn/hood</a>
				</p>
				<p>(YongBin + 32 'n's, 33 'n' in total)</p>
			</section>

		</div>

	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/reveal.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/zoom/zoom.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/notes/notes.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/search/search.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/markdown/markdown.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.0.4/plugin/highlight/highlight.min.js"></script>
	<script lang="javascript">
		// Also available as an ES module, see:
		// https://revealjs.com/initialization/
		Reveal.initialize({
			controls: true,
			progress: true,
			center: true,
			hash: true,
			slideNumber: true,

			highlight: {
				beforeHighlight: hljs => {
					hljs.registerLanguage('trojanability', function () {
						return {
							case_insensitive: false, // language is case-insensitive
							keywords: { keyword: 'camera microphone sms location call clipboard without steal token tokens evidence stream' },
							contains: []
						}
					})
				}
			},

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight]
		})
		register_dhcp_slide_handler();
		register_dns_slide_handler();
		register_tls_slide_handler();

	</script>

</body>

</html>
